{% load static %}
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="{% static 'source/libraries/bootstrap/css/bootstrap.min.css' %}">
	
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous"> -->

	<title></title>
</head>
<body>
	<style type="text/css">
		.logo {
			display: flex;
			justify-content: center;
		}
		.logo img {
			width: 300px;

		}
		body {
			color: #fff;
			background: linear-gradient(#9a9, #ddd);
			/*background: #0D9A49;*/
			/*background: #aaa;*/
		}
		h4 {
			text-align: center;
		}
		.conts {
			/*position: fixed;*/
			/*background: #006838;*/

			border-radius: 20px;
			left: 0;
			bottom: 0;
			top: 0;
			width: 100%;
			/*border-radius: 0px 0px 50% 0%;*/
			/*border: 1px solid #f00;*/
		}

		footer {
			/*position: absolute;*/
			/*bottom: 0;*/
			width: 100%;
			background: #008137;
		}

		.logo-google {
			text-align: center;
			/*width: 320px*/
		}

		.logo-google img {
			width: 50px;
			padding-right: 15px;
			border-right: 2px solid #000;
		}
		.coms {
			display: none;
		}
		.btn_ini {
			display: flex;
			justify-content: center;
		}
	</style>

	<section class="container-fluid">
		<br>
		<div class="conts p-5">
			<div>
	
				<div class="form">
					<form id="form_login" class="form-login col-12">
	
						<div class="col-12">
							<h3 style="text-align: center; color: #006838; font-weight: bold;">TESTIGOS VERDES</h3>
							<figure class="logo">
								<img src="{% static 'source/img/LOGO.png' %}">
							</figure>
							<p style="text-align: center; color: #000;">
								A continuación, usted podrá inscribir los <b>Testigos Electorales</b> (tanto de Mesa
								principal y de Escrutinio) para Los Consejos Municipales y Locales de Juventud del 2025.
								<br><br>
								POR FAVOR, tenga en cuenta que esta plataforma está diseñada únicamente para listas Verdes
								<!-- <b>NO EN COALICIÓN.</b> -->
								<!-- <br><br>
								Por esta razón, <b>NO SE PODRÁN INSCRIBIR TESTIGOS ELECTORALES DE CANDIDATURAS EN
									COALICIÓN.</b>-->
								<br><br> 
								Para llevar a cabo la inscripción de sus Testigos Electorales con éxito, deberá seleccionar
								el Departamento y el Municipio donde desea postular a sus testigos. <b>Tenga en cuenta que
									solo aparecerán las mesas que están libres</b>, para la postulación de testigos, las mesas
								que no aparezcan en determinado puesto de votación es por que ya tienen un testigo asignado.
							</p>
							<br>
							<div class="row">
								<div class="col">
									<select class="form-control" name="corp" required id="corp">
										<option value="">Seleccionar corporación</option>
										<option value="CLJ">CONSEJO LOCAL JUVENTUD</option>
										<option value="CMJ">CONSEJO MUNICIPAL JUVENTUD</option>
										<!-- <option value="ASAMBLEA">ASAMBLEA</option>
										<option value="GOBERNADOR">GOBERNADOR</option>
										<option value="ALCALDE">ALCALDE</option>
										<option value="CONCEJO">CONCEJO</option>
										<option value="JAL">JAL</option> -->
									</select>
								</div>
								<br>
								<div class="col">
									<select class="form-control" name="deps" required id="deps">
										<option value=0>Seleccionar departamento</option>
										{% for d in departamentos %}
											<option value="{{d.id_d}}">{{d.name_dept}}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="p-2">
								<br>
								<div class="row">
									<select class="form-control" name="muns" required id="muns">
										<option value=0>Seleccionar municipio</option>
									</select>
								</div>
								<br class="coms">
								<div class="row coms">
									<select class="form-control" name="coms" id="coms">
										<option value=0>Seleccionar localidad</option>
									</select>
								</div>
								<br>
								<div class="row">
									<select class="form-control" name="candidato" required id="candidato">
										<option>Seleccionar candidato</option>
									</select>
								</div>
								<br>
								<div class="row">
									<label style="color: #700;">
										<b>
											<i>INGRESE EL CORREO ELECTRÓNICO CON EL QUE EL CANDIDATO(A) SE REGISTRÓ COMO MILITANTE EN LA PLATAFORMA DEL PARTIDO ALIANZA VERDE</i>
										</b>
									</label>
									<input required type="email" name="email" id="email" class="form-control">
								</div>
								<br>
								{% csrf_token %}
							</div>
	
							<div class="btn_ini">
								<button class="btn btn-warning logo-google">
									<img src="{% static 'source/img/user.png' %}">&nbsp;
									<b>Continuar con la inscripción</b>
								</button>
							</div>
	
						</div>
						<br>
					</form>
				</div>
			</div>
	
		</div>
	</section>


	<footer id="sp-footer" class="ts-footer">


	<div class="modal fade" id="modal-errors1" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
		aria-labelledby="staticBackdropLabel" aria-hidden="true">
		<div class="modal-dialog" style="color: #000;">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="modal-title1">Modal title</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" id="modal-body1">
	
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">OK</button>
				</div>
			</div>
		</div>
	</div>
				
	
	<div class="row">
		<div id="sp-footer1" class="col-lg-12 ">
			<div class="sp-column ">
				<div class="sp-module ">
					<div class="sp-module-content">
						<div class="mod-sppagebuilder  sp-page-builder" data-module_id="96">
							<div class="page-content">
								<div id="section-id-1695409944068" class="sppb-section">
									<div class="sppb-container-inner">
										<div class="sppb-row">
											<div class="sppb-col-md-12" id="column-wrap-id-1695409944067">
												<div id="column-id-1695409944067" class="sppb-column">
													<div class="sppb-column-addons">
														<div id="sppb-addon-wrapper-1695409944071"
															class="sppb-addon-wrapper">
															<div id="sppb-addon-1695409944071"
																class=" sppb-wow zoomIn clearfix  sppb-animated"
																data-sppb-wow-duration="1000ms"
																style="visibility: visible; animation-duration: 1000ms; animation-name: zoomIn;">
																<div class="sppb-addon sppb-addon-text-block  ">
																	<div class="sppb-addon-content">
																		<br>
																		<div style="text-align: center;"><span
																				style="font-size: 12pt;">Dirección: Calle 36
																				# 28 A - 24 Bogotá</span></div>
																		<div style="text-align: center;"><span
																				style="font-size: 12pt;">Horario de atención
																				y recepción de correspondencia:</span></div>
																		<div style="text-align: center;"><span
																				style="font-size: 12pt;">De lunes a Viernes
																				de 8:00 a. m. a 1:00 p. m. y de 2:00 p.m a
																				5:00.pm</span></div>
																		<div style="text-align: center;"><span
																				style="font-size: 12pt;">Teléfono: (1)
																				6563000 / (1) 6563001</span></div>
																		<div style="text-align: center;">
																			<span style="font-size: 12pt;">Correo: sistemas@partidoverde.org.co</span>
																			<br>
																			<span style="font-size: 12pt;">Soporte Celular: <b>315 773 0175</b></span>
																			<br>
																			<span style="font-size: 12pt;">© 2025</span>
																		</div>
																	</div>
																</div>
	
																<style type="text/css">
																	#sppb-addon-wrapper-1695409944071 {
																		margin: 0px 0px 30px 0px;
																	}
	
																	#sppb-addon-1695409944071 {
																		color: #ffffff;
																		background-color: #008137;
																		box-shadow: 0 0 0 0 #ffffff;
																	}
	
																	#sppb-addon-1695409944071 {}
	
																	#sppb-addon-1695409944071.sppb-element-loaded {}
	
																	@media (min-width: 768px) and (max-width: 991px) {
																		#sppb-addon-1695409944071 {}
																	}
	
																	@media (max-width: 767px) {
																		#sppb-addon-1695409944071 {}
																	}
	
																	@media (min-width: 768px) and (max-width: 991px) {}
	
																	@media (max-width: 767px) {}
	
																	.sp-page-builder .page-content #section-id-1695409944068 {
																		padding: 0px 0px 0px 0px;
																		margin: 0px 0px 0px 0px;
																		box-shadow: 0 0 0 0 #ffffff;
																	}
	
																	#column-id-1695409944067 {
																		box-shadow: 0 0 0 0 #fff;
																	}
																</style>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
                    
    </footer>
	
	<script type="text/javascript" src="{% static 'source/libraries/jquery.js' %}"></script>
	<script type="text/javascript" src="{% static 'source/libraries/bootstrap/js/bootstrap.min.js' %}"></script>
	<script type="text/javascript">
		var deps = $("#deps");
		var muns = $("#muns");
		var coms = $("#coms");
		var corp = $("#corp");
		var cand = $("#candidato");

		corp.on("change", function (e) {
			c = $(this);
			//console.log('c',corp.val())
			if (corp.val()!=='') {

				$("#deps").show();
				$("#muns").show();
				$("#coms").show();
				$("#candidato").show();

				$('#coms').empty();
				$('#coms').append('<option value=0>Seleccionar localidad</option>');

		
				$('#candidato').empty();
				$('#candidato').append('<option value=0>Seleccionar candidato</option>');


				$('#muns').empty();
				$('#muns').append('<option value=0>Seleccionar municipio</option>');


				
				$.ajax({
					url: '/cargar-departamentos/',
					data: {
						'corporacion': c.val()
					},
					success: function (data) {
						$('#deps').empty();
						$('#deps').append('<option value=0>Seleccionar departamento</option>');
						$.each(data, function (key, value) {
							$('#deps').append('<option value="' + value.id_d + '">' + value.name_dept + '</option>');
						});
					}
				});
			} else {
				//$('#deps').empty();
				$("#deps").hide();
				$("#muns").hide();
				$('#muns').empty();
				$('#muns').append('<option value=0>Seleccionar municipio</option>');

				$("#coms").hide();
				$('#coms').empty();
				$('#coms').append('<option value=0>Seleccionar localidad</option>');

				$("#candidato").hide();	
				$('#candidato').empty();
				$('#candidato').append('<option value=0>Seleccionar candidato</option>');

			}
			//getCandidatos();
		});		

		$('#deps').change(function () {

			//$('.coms').empty();
			$(".coms").hide();
			//$('#candidato').hide();
			//$('#candidato').empty();
			$('#candidato').empty();
			$('#candidato').append('<option value=0>Seleccionar candidato</option>');


			c = $(this);

			$.ajax({
				url: '/cargar-municipios/',
				data: {
					'departamento': deps.val()
				},
				success: function (data) {
					$('#muns').empty();
					$('#muns').append('<option value=0>Seleccionar municipio</option>');
					$.each(data, function (key, value) {
						$('#muns').append('<option value="' + value.id_m + '">' + value.name_mun + '</option>');
					});
				}
			});
		});

		muns.on("change", function (e) {

			$('#candidato').empty();
			$('#candidato').append('<option value=0>Seleccionar candidato</option>');


			$.get("/cargar-comunas/?mun=" + muns.val(), function (e) {
				var data = e;//JSON.parse(e);
				var cms = '<option value="0">Seleccionar localidad</option>';

				for (i = 0; i < data.length; i++) {
					cms += '<option value="' + data[i].id_c + '">' + data[i].name_com + '</option>';
				}

				coms.html(cms);
				console.log('comunas',data.length)

				if (data.length > 0) {
					$(".coms").show();
					
				} else {
					$(".coms").hide();
				}

				//if (c.val() == "CLJ" || deps.val() == 10) {
					getCandidatos();
				//}
			});
		});

		coms.on("change", function (e) {
			$('#candidato').empty();
			$('#candidato').append('<option value=0>Seleccionar candidato</option>');
			if (coms.val() !== "0"){				
				getCandidatos();
			}
		});

		function getCandidatos() {
			
			if (corp.val() != '' && deps.val() != 0 && muns.val() != 0) {
				$.get("/cargar-candidatos/?corp=" + corp.val() + "&dep=" + deps.val() + "&mun=" + muns.val() + "&com=" + coms.val(), function (e) {
					var data = e;//JSON.parse(e);
					console.log(data)
					var cts = '<option value="">Seleccionar candidato</option>';
					for (i = 0; i < data.length; i++) {
						cts += '<option value="' + data[i].id_ct + '">' + data[i].name_can + '</option>';
					}
					cand.html(cts);
				});
			}
		}

		$("#form_login").on("submit", function (eve) {
			e = eve.preventDefault();
			form = $(this)
			data_form = form.serialize();
			if (deps.val() == 10) {
				if ($("#coms").val() == "" || $("#coms").val() == "0") {
					$("#modal-errors1").modal("show");
					$("#modal-title1").text("ERROR");
					$("#modal-body1").html("Por favor, seleccione una corporación");
				} else {
					send();
				}
			} else {
				send();
			}

		});

		function send() {
			$.post("/login/", data_form, function (e, eve) {
				var data = e //JSON.parse(e);
				if (data.status == "ok") {
					location.href = data.action;
				} else {
					$("#modal-errors1").modal("show");
					$("#modal-title1").text("ERROR");
					$("#modal-body1").html(data.action);
				}
			});
		}

	</script>
</body>
</html>